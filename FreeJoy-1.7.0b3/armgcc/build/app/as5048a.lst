ARM GAS  /tmp/ccsKh3k1.s 			page 1


   1              		.cpu cortex-m3
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 2
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"as5048a.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.reset_err_flag,"ax",%progbits
  16              		.align	1
  17              		.p2align 2,,3
  18              		.global	reset_err_flag
  19              		.arch armv7-m
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu softvfp
  25              	reset_err_flag:
  26              	.LVL0:
  27              	.LFB29:
  28              		.file 1 "../application/Src/as5048a.c"
   1:../application/Src/as5048a.c **** /**
   2:../application/Src/as5048a.c ****   ******************************************************************************
   3:../application/Src/as5048a.c ****   * @file           : as5048a.c
   4:../application/Src/as5048a.c ****   * @brief          : AS5048A sensors driver implementation
   5:../application/Src/as5048a.c **** 			
   6:../application/Src/as5048a.c **** 		FreeJoy software for game device controllers
   7:../application/Src/as5048a.c ****     Copyright (C) 2020  Yury Vostrenkov (yuvostrenkov@gmail.com)
   8:../application/Src/as5048a.c **** 
   9:../application/Src/as5048a.c ****     This program is free software: you can redistribute it and/or modify
  10:../application/Src/as5048a.c ****     it under the terms of the GNU General Public License as published by
  11:../application/Src/as5048a.c ****     the Free Software Foundation, either version 3 of the License, or
  12:../application/Src/as5048a.c ****     (at your option) any later version.
  13:../application/Src/as5048a.c **** 
  14:../application/Src/as5048a.c ****     This program is distributed in the hope that it will be useful,
  15:../application/Src/as5048a.c ****     but WITHOUT ANY WARRANTY; without even the implied warranty of
  16:../application/Src/as5048a.c ****     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  17:../application/Src/as5048a.c ****     GNU General Public License for more details.
  18:../application/Src/as5048a.c **** 
  19:../application/Src/as5048a.c ****     You should have received a copy of the GNU General Public License
  20:../application/Src/as5048a.c ****     along with this program.  If not, see <https://www.gnu.org/licenses/>.
  21:../application/Src/as5048a.c **** 		
  22:../application/Src/as5048a.c ****   ******************************************************************************
  23:../application/Src/as5048a.c ****   */
  24:../application/Src/as5048a.c **** 
  25:../application/Src/as5048a.c **** #include "as5048a.h"
  26:../application/Src/as5048a.c **** 
  27:../application/Src/as5048a.c **** uint8_t gtmp_buf[2];
  28:../application/Src/as5048a.c **** 
  29:../application/Src/as5048a.c **** void reset_err_flag(sensor_t * sensor){
  29              		.loc 1 29 39 view -0
ARM GAS  /tmp/ccsKh3k1.s 			page 2


  30              		.cfi_startproc
  31              		@ args = 0, pretend = 0, frame = 0
  32              		@ frame_needed = 0, uses_anonymous_args = 0
  30:../application/Src/as5048a.c **** 	uint16_t tmp;
  33              		.loc 1 30 2 view .LVU1
  31:../application/Src/as5048a.c **** 	// CS low
  32:../application/Src/as5048a.c **** 	pin_config[sensor->source].port->ODR &= ~pin_config[sensor->source].pin;
  34              		.loc 1 32 2 view .LVU2
  29:../application/Src/as5048a.c **** 	uint16_t tmp;
  35              		.loc 1 29 39 is_stmt 0 view .LVU3
  36 0000 70B5     		push	{r4, r5, r6, lr}
  37              	.LCFI0:
  38              		.cfi_def_cfa_offset 16
  39              		.cfi_offset 4, -16
  40              		.cfi_offset 5, -12
  41              		.cfi_offset 6, -8
  42              		.cfi_offset 14, -4
  33:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
  34:../application/Src/as5048a.c **** 	gtmp_buf[1] = 0x01;
  43              		.loc 1 34 14 view .LVU4
  44 0002 0122     		movs	r2, #1
  33:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
  45              		.loc 1 33 14 view .LVU5
  46 0004 4024     		movs	r4, #64
  32:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
  47              		.loc 1 32 19 view .LVU6
  48 0006 90F90B30 		ldrsb	r3, [r0, #11]
  32:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
  49              		.loc 1 32 28 view .LVU7
  50 000a 114D     		ldr	r5, .L6
  29:../application/Src/as5048a.c **** 	uint16_t tmp;
  51              		.loc 1 29 39 view .LVU8
  52 000c 0646     		mov	r6, r0
  32:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
  53              		.loc 1 32 28 view .LVU9
  54 000e 55F83310 		ldr	r1, [r5, r3, lsl #3]
  32:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
  55              		.loc 1 32 69 view .LVU10
  56 0012 05EBC303 		add	r3, r5, r3, lsl #3
  57 0016 9888     		ldrh	r0, [r3, #4]
  58              	.LVL1:
  32:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
  59              		.loc 1 32 39 view .LVU11
  60 0018 CB68     		ldr	r3, [r1, #12]
  61 001a 23EA0003 		bic	r3, r3, r0
  33:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
  62              		.loc 1 33 14 view .LVU12
  63 001e 0D48     		ldr	r0, .L6+4
  32:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
  64              		.loc 1 32 39 view .LVU13
  65 0020 CB60     		str	r3, [r1, #12]
  33:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
  66              		.loc 1 33 2 is_stmt 1 view .LVU14
  35:../application/Src/as5048a.c **** 	
  36:../application/Src/as5048a.c **** 	SPI_HalfDuplex_Transmit(&gtmp_buf[0], 2, AS5048A_SPI_MODE);
  67              		.loc 1 36 2 is_stmt 0 view .LVU15
  68 0022 0221     		movs	r1, #2
ARM GAS  /tmp/ccsKh3k1.s 			page 3


  33:../application/Src/as5048a.c **** 	gtmp_buf[1] = 0x01;
  69              		.loc 1 33 14 view .LVU16
  70 0024 0470     		strb	r4, [r0]
  34:../application/Src/as5048a.c **** 	
  71              		.loc 1 34 2 is_stmt 1 view .LVU17
  72              		.loc 1 36 2 view .LVU18
  34:../application/Src/as5048a.c **** 	
  73              		.loc 1 34 14 is_stmt 0 view .LVU19
  74 0026 4270     		strb	r2, [r0, #1]
  75              		.loc 1 36 2 view .LVU20
  76 0028 FFF7FEFF 		bl	SPI_HalfDuplex_Transmit
  77              	.LVL2:
  37:../application/Src/as5048a.c **** 	
  38:../application/Src/as5048a.c **** 	do{
  39:../application/Src/as5048a.c **** 		tmp = DMA_GetCurrDataCounter(DMA1_Channel3);
  78              		.loc 1 39 9 view .LVU21
  79 002c 0A4C     		ldr	r4, .L6+8
  80              	.L2:
  38:../application/Src/as5048a.c **** 		tmp = DMA_GetCurrDataCounter(DMA1_Channel3);
  81              		.loc 1 38 2 is_stmt 1 discriminator 1 view .LVU22
  82              		.loc 1 39 3 discriminator 1 view .LVU23
  83              		.loc 1 39 9 is_stmt 0 discriminator 1 view .LVU24
  84 002e 2046     		mov	r0, r4
  85 0030 FFF7FEFF 		bl	DMA_GetCurrDataCounter
  86              	.LVL3:
  40:../application/Src/as5048a.c **** 	}  while(tmp!=0);
  87              		.loc 1 40 10 is_stmt 1 discriminator 1 view .LVU25
  88              		.loc 1 40 2 is_stmt 0 discriminator 1 view .LVU26
  89 0034 0028     		cmp	r0, #0
  90 0036 FAD1     		bne	.L2
  41:../application/Src/as5048a.c **** 	
  42:../application/Src/as5048a.c **** 	// CS high
  43:../application/Src/as5048a.c **** 	pin_config[sensor->source].port->ODR |= pin_config[sensor->source].pin;
  91              		.loc 1 43 2 is_stmt 1 view .LVU27
  92              		.loc 1 43 19 is_stmt 0 view .LVU28
  93 0038 96F90B30 		ldrsb	r3, [r6, #11]
  94              		.loc 1 43 28 view .LVU29
  95 003c 55F83320 		ldr	r2, [r5, r3, lsl #3]
  96              		.loc 1 43 68 view .LVU30
  97 0040 05EBC305 		add	r5, r5, r3, lsl #3
  98 0044 AB88     		ldrh	r3, [r5, #4]
  99              		.loc 1 43 39 view .LVU31
 100 0046 D168     		ldr	r1, [r2, #12]
 101 0048 0B43     		orrs	r3, r3, r1
 102 004a D360     		str	r3, [r2, #12]
  44:../application/Src/as5048a.c **** 	
  45:../application/Src/as5048a.c **** }
 103              		.loc 1 45 1 view .LVU32
 104 004c 70BD     		pop	{r4, r5, r6, pc}
 105              	.LVL4:
 106              	.L7:
 107              		.loc 1 45 1 view .LVU33
 108 004e 00BF     		.align	2
 109              	.L6:
 110 0050 00000000 		.word	pin_config
 111 0054 00000000 		.word	gtmp_buf
 112 0058 30000240 		.word	1073872944
ARM GAS  /tmp/ccsKh3k1.s 			page 4


 113              		.cfi_endproc
 114              	.LFE29:
 116              		.section	.text.AS5048A_GetData,"ax",%progbits
 117              		.align	1
 118              		.p2align 2,,3
 119              		.global	AS5048A_GetData
 120              		.syntax unified
 121              		.thumb
 122              		.thumb_func
 123              		.fpu softvfp
 125              	AS5048A_GetData:
 126              	.LVL5:
 127              	.LFB30:
  46:../application/Src/as5048a.c **** /**
  47:../application/Src/as5048a.c ****   * @brief AS5048A get measured data
  48:../application/Src/as5048a.c ****   * @param data: variable for storing data
  49:../application/Src/as5048a.c ****   * @param sensor: Sensor struct
  50:../application/Src/as5048a.c ****   * @retval status
  51:../application/Src/as5048a.c ****   */
  52:../application/Src/as5048a.c **** int AS5048A_GetData(uint16_t * data, sensor_t * sensor, uint8_t channel)
  53:../application/Src/as5048a.c **** {
 128              		.loc 1 53 1 is_stmt 1 view -0
 129              		.cfi_startproc
 130              		@ args = 0, pretend = 0, frame = 0
 131              		@ frame_needed = 0, uses_anonymous_args = 0
  54:../application/Src/as5048a.c **** 	int ret = 0;
 132              		.loc 1 54 2 view .LVU35
  53:../application/Src/as5048a.c **** 	int ret = 0;
 133              		.loc 1 53 1 is_stmt 0 view .LVU36
 134 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 135              	.LCFI1:
 136              		.cfi_def_cfa_offset 24
 137              		.cfi_offset 3, -24
 138              		.cfi_offset 4, -20
 139              		.cfi_offset 5, -16
 140              		.cfi_offset 6, -12
 141              		.cfi_offset 7, -8
 142              		.cfi_offset 14, -4
  53:../application/Src/as5048a.c **** 	int ret = 0;
 143              		.loc 1 53 1 view .LVU37
 144 0002 0646     		mov	r6, r0
 145 0004 0D46     		mov	r5, r1
  55:../application/Src/as5048a.c **** 	uint16_t tmp;
  56:../application/Src/as5048a.c **** 	// wait till the DMA channel has finished
  57:../application/Src/as5048a.c **** 	do{
  58:../application/Src/as5048a.c **** 		tmp = DMA_GetCurrDataCounter(DMA1_Channel2);
 146              		.loc 1 58 9 view .LVU38
 147 0006 224C     		ldr	r4, .L20
 148              	.LVL6:
 149              	.L9:
  55:../application/Src/as5048a.c **** 	uint16_t tmp;
 150              		.loc 1 55 2 is_stmt 1 discriminator 1 view .LVU39
  57:../application/Src/as5048a.c **** 		tmp = DMA_GetCurrDataCounter(DMA1_Channel2);
 151              		.loc 1 57 2 discriminator 1 view .LVU40
 152              		.loc 1 58 3 discriminator 1 view .LVU41
 153              		.loc 1 58 9 is_stmt 0 discriminator 1 view .LVU42
 154 0008 2046     		mov	r0, r4
ARM GAS  /tmp/ccsKh3k1.s 			page 5


 155 000a FFF7FEFF 		bl	DMA_GetCurrDataCounter
 156              	.LVL7:
  59:../application/Src/as5048a.c **** 	}  while(tmp!=0);
 157              		.loc 1 59 10 is_stmt 1 discriminator 1 view .LVU43
 158              		.loc 1 59 2 is_stmt 0 discriminator 1 view .LVU44
 159 000e 0028     		cmp	r0, #0
 160 0010 FAD1     		bne	.L9
  60:../application/Src/as5048a.c **** 	tmp = sensor->data[0];
 161              		.loc 1 60 2 is_stmt 1 view .LVU45
 162              	.LVL8:
  61:../application/Src/as5048a.c **** 	tmp = (tmp << 8) | sensor->data[1];
 163              		.loc 1 61 2 view .LVU46
 164              		.loc 1 61 13 is_stmt 0 view .LVU47
 165 0012 AB7B     		ldrb	r3, [r5, #14]	@ zero_extendqisi2
 166              		.loc 1 61 33 view .LVU48
 167 0014 EC7B     		ldrb	r4, [r5, #15]	@ zero_extendqisi2
 168              		.loc 1 61 6 view .LVU49
 169 0016 44EA0324 		orr	r4, r4, r3, lsl #8
 170              	.LVL9:
  62:../application/Src/as5048a.c **** 	*data = tmp & 0x3FFF;
 171              		.loc 1 62 2 is_stmt 1 view .LVU50
 172              		.loc 1 62 14 is_stmt 0 view .LVU51
 173 001a C4F30D03 		ubfx	r3, r4, #0, #14
  63:../application/Src/as5048a.c **** 	// check error bit
  64:../application/Src/as5048a.c **** 	if((tmp&0x4000)!=0){
 174              		.loc 1 64 4 view .LVU52
 175 001e 14F48040 		ands	r0, r4, #16384
  62:../application/Src/as5048a.c **** 	*data = tmp & 0x3FFF;
 176              		.loc 1 62 8 view .LVU53
 177 0022 3380     		strh	r3, [r6]	@ movhi
 178              		.loc 1 64 2 is_stmt 1 view .LVU54
 179              		.loc 1 64 4 is_stmt 0 view .LVU55
 180 0024 0DD1     		bne	.L19
 181              	.LVL10:
 182              	.L10:
  65:../application/Src/as5048a.c **** 		// reset err flag with 0x4001 command
  66:../application/Src/as5048a.c **** 		reset_err_flag(sensor);
  67:../application/Src/as5048a.c **** 		ret = -1;
  68:../application/Src/as5048a.c **** 	}
  69:../application/Src/as5048a.c **** 	// check parity
  70:../application/Src/as5048a.c **** 	tmp ^= tmp >> 8;
 183              		.loc 1 70 2 is_stmt 1 view .LVU56
 184              		.loc 1 70 6 is_stmt 0 view .LVU57
 185 0026 84EA1424 		eor	r4, r4, r4, lsr #8
 186              	.LVL11:
  71:../application/Src/as5048a.c **** 	tmp ^= tmp >> 4;
 187              		.loc 1 71 2 is_stmt 1 view .LVU58
 188              		.loc 1 71 6 is_stmt 0 view .LVU59
 189 002a 84EA1414 		eor	r4, r4, r4, lsr #4
 190              	.LVL12:
  72:../application/Src/as5048a.c **** 	tmp ^= tmp >> 2;
 191              		.loc 1 72 2 is_stmt 1 view .LVU60
 192              		.loc 1 72 6 is_stmt 0 view .LVU61
 193 002e 84EA9404 		eor	r4, r4, r4, lsr #2
 194              	.LVL13:
  73:../application/Src/as5048a.c **** 	tmp ^= tmp >> 1;
 195              		.loc 1 73 2 is_stmt 1 view .LVU62
ARM GAS  /tmp/ccsKh3k1.s 			page 6


  74:../application/Src/as5048a.c **** 	if((tmp & 1)==1) ret = -2;
 196              		.loc 1 74 2 view .LVU63
  73:../application/Src/as5048a.c **** 	tmp ^= tmp >> 1;
 197              		.loc 1 73 6 is_stmt 0 view .LVU64
 198 0032 84EA5404 		eor	r4, r4, r4, lsr #1
 199              	.LVL14:
 200              		.loc 1 74 23 view .LVU65
 201 0036 14F0010F 		tst	r4, #1
  75:../application/Src/as5048a.c **** 	return ret;
  76:../application/Src/as5048a.c **** }
 202              		.loc 1 76 1 view .LVU66
 203 003a 18BF     		it	ne
 204 003c 6FF00100 		mvnne	r0, #1
 205              	.LVL15:
 206              		.loc 1 76 1 view .LVU67
 207 0040 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 208              	.LVL16:
 209              	.L19:
  66:../application/Src/as5048a.c **** 		ret = -1;
 210              		.loc 1 66 3 is_stmt 1 view .LVU68
 211              	.LBB4:
 212              	.LBI4:
  29:../application/Src/as5048a.c **** 	uint16_t tmp;
 213              		.loc 1 29 6 view .LVU69
 214              	.LBB5:
  30:../application/Src/as5048a.c **** 	// CS low
 215              		.loc 1 30 2 view .LVU70
  32:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
 216              		.loc 1 32 2 view .LVU71
  34:../application/Src/as5048a.c **** 	
 217              		.loc 1 34 14 is_stmt 0 view .LVU72
 218 0042 0122     		movs	r2, #1
  33:../application/Src/as5048a.c **** 	gtmp_buf[1] = 0x01;
 219              		.loc 1 33 14 view .LVU73
 220 0044 4026     		movs	r6, #64
 221              	.LVL17:
  32:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
 222              		.loc 1 32 19 view .LVU74
 223 0046 95F90B30 		ldrsb	r3, [r5, #11]
  32:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
 224              		.loc 1 32 28 view .LVU75
 225 004a 124F     		ldr	r7, .L20+4
 226 004c 57F83310 		ldr	r1, [r7, r3, lsl #3]
  32:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
 227              		.loc 1 32 69 view .LVU76
 228 0050 07EBC303 		add	r3, r7, r3, lsl #3
 229 0054 9888     		ldrh	r0, [r3, #4]
  32:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
 230              		.loc 1 32 39 view .LVU77
 231 0056 CB68     		ldr	r3, [r1, #12]
 232 0058 23EA0003 		bic	r3, r3, r0
  33:../application/Src/as5048a.c **** 	gtmp_buf[1] = 0x01;
 233              		.loc 1 33 14 view .LVU78
 234 005c 0E48     		ldr	r0, .L20+8
  32:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x40;
 235              		.loc 1 32 39 view .LVU79
 236 005e CB60     		str	r3, [r1, #12]
ARM GAS  /tmp/ccsKh3k1.s 			page 7


  33:../application/Src/as5048a.c **** 	gtmp_buf[1] = 0x01;
 237              		.loc 1 33 2 is_stmt 1 view .LVU80
  36:../application/Src/as5048a.c **** 	
 238              		.loc 1 36 2 is_stmt 0 view .LVU81
 239 0060 0221     		movs	r1, #2
  33:../application/Src/as5048a.c **** 	gtmp_buf[1] = 0x01;
 240              		.loc 1 33 14 view .LVU82
 241 0062 0670     		strb	r6, [r0]
  34:../application/Src/as5048a.c **** 	
 242              		.loc 1 34 2 is_stmt 1 view .LVU83
  36:../application/Src/as5048a.c **** 	
 243              		.loc 1 36 2 view .LVU84
  34:../application/Src/as5048a.c **** 	
 244              		.loc 1 34 14 is_stmt 0 view .LVU85
 245 0064 4270     		strb	r2, [r0, #1]
  36:../application/Src/as5048a.c **** 	
 246              		.loc 1 36 2 view .LVU86
 247 0066 FFF7FEFF 		bl	SPI_HalfDuplex_Transmit
 248              	.LVL18:
  39:../application/Src/as5048a.c **** 	}  while(tmp!=0);
 249              		.loc 1 39 9 view .LVU87
 250 006a 0C4E     		ldr	r6, .L20+12
 251              	.L11:
  38:../application/Src/as5048a.c **** 		tmp = DMA_GetCurrDataCounter(DMA1_Channel3);
 252              		.loc 1 38 2 is_stmt 1 view .LVU88
  39:../application/Src/as5048a.c **** 	}  while(tmp!=0);
 253              		.loc 1 39 3 view .LVU89
  39:../application/Src/as5048a.c **** 	}  while(tmp!=0);
 254              		.loc 1 39 9 is_stmt 0 view .LVU90
 255 006c 3046     		mov	r0, r6
 256 006e FFF7FEFF 		bl	DMA_GetCurrDataCounter
 257              	.LVL19:
  40:../application/Src/as5048a.c **** 	
 258              		.loc 1 40 10 is_stmt 1 view .LVU91
  40:../application/Src/as5048a.c **** 	
 259              		.loc 1 40 2 is_stmt 0 view .LVU92
 260 0072 0028     		cmp	r0, #0
 261 0074 FAD1     		bne	.L11
  43:../application/Src/as5048a.c **** 	
 262              		.loc 1 43 2 is_stmt 1 view .LVU93
  43:../application/Src/as5048a.c **** 	
 263              		.loc 1 43 19 is_stmt 0 view .LVU94
 264 0076 95F90B30 		ldrsb	r3, [r5, #11]
 265              	.LBE5:
 266              	.LBE4:
  67:../application/Src/as5048a.c **** 	}
 267              		.loc 1 67 7 view .LVU95
 268 007a 4FF0FF30 		mov	r0, #-1
 269              	.LVL20:
 270              	.LBB7:
 271              	.LBB6:
  43:../application/Src/as5048a.c **** 	
 272              		.loc 1 43 28 view .LVU96
 273 007e 57F83320 		ldr	r2, [r7, r3, lsl #3]
  43:../application/Src/as5048a.c **** 	
 274              		.loc 1 43 68 view .LVU97
 275 0082 07EBC307 		add	r7, r7, r3, lsl #3
ARM GAS  /tmp/ccsKh3k1.s 			page 8


 276 0086 BB88     		ldrh	r3, [r7, #4]
  43:../application/Src/as5048a.c **** 	
 277              		.loc 1 43 39 view .LVU98
 278 0088 D168     		ldr	r1, [r2, #12]
 279 008a 0B43     		orrs	r3, r3, r1
 280 008c D360     		str	r3, [r2, #12]
  45:../application/Src/as5048a.c **** /**
 281              		.loc 1 45 1 view .LVU99
 282 008e CAE7     		b	.L10
 283              	.L21:
 284              		.align	2
 285              	.L20:
 286 0090 1C000240 		.word	1073872924
 287 0094 00000000 		.word	pin_config
 288 0098 00000000 		.word	gtmp_buf
 289 009c 30000240 		.word	1073872944
 290              	.LBE6:
 291              	.LBE7:
 292              		.cfi_endproc
 293              	.LFE30:
 295              		.section	.text.AS5048A_StartDMA,"ax",%progbits
 296              		.align	1
 297              		.p2align 2,,3
 298              		.global	AS5048A_StartDMA
 299              		.syntax unified
 300              		.thumb
 301              		.thumb_func
 302              		.fpu softvfp
 304              	AS5048A_StartDMA:
 305              	.LVL21:
 306              	.LFB31:
  77:../application/Src/as5048a.c **** 
  78:../application/Src/as5048a.c **** 
  79:../application/Src/as5048a.c **** /**
  80:../application/Src/as5048a.c ****   * @brief AS5048A start processing with DMA
  81:../application/Src/as5048a.c ****   * @param sensor: Sensor struct
  82:../application/Src/as5048a.c ****   * @retval None
  83:../application/Src/as5048a.c ****   */
  84:../application/Src/as5048a.c **** void AS5048A_StartDMA(sensor_t * sensor)
  85:../application/Src/as5048a.c **** {	
 307              		.loc 1 85 1 is_stmt 1 view -0
 308              		.cfi_startproc
 309              		@ args = 0, pretend = 0, frame = 0
 310              		@ frame_needed = 0, uses_anonymous_args = 0
 311              		@ link register save eliminated.
  86:../application/Src/as5048a.c **** 	
  87:../application/Src/as5048a.c **** 	sensor->rx_complete = 0;
 312              		.loc 1 87 2 view .LVU101
  88:../application/Src/as5048a.c **** 	sensor->tx_complete = 1;
 313              		.loc 1 88 2 view .LVU102
  87:../application/Src/as5048a.c **** 	sensor->tx_complete = 1;
 314              		.loc 1 87 22 is_stmt 0 view .LVU103
 315 0000 4FF48072 		mov	r2, #256
  85:../application/Src/as5048a.c **** 	
 316              		.loc 1 85 1 view .LVU104
 317 0004 70B4     		push	{r4, r5, r6}
 318              	.LCFI2:
ARM GAS  /tmp/ccsKh3k1.s 			page 9


 319              		.cfi_def_cfa_offset 12
 320              		.cfi_offset 4, -12
 321              		.cfi_offset 5, -8
 322              		.cfi_offset 6, -4
  89:../application/Src/as5048a.c **** 
  90:../application/Src/as5048a.c **** 	gtmp_buf[0] = 0x3F;		// Read Meas. command: 0x3FFF
 323              		.loc 1 90 14 view .LVU105
 324 0006 3F25     		movs	r5, #63
  91:../application/Src/as5048a.c **** 	gtmp_buf[1] = 0xFF;		// 
 325              		.loc 1 91 14 view .LVU106
 326 0008 FF24     		movs	r4, #255
  92:../application/Src/as5048a.c **** 	
  93:../application/Src/as5048a.c **** 	// CS low
  94:../application/Src/as5048a.c **** 	pin_config[sensor->source].port->ODR &= ~pin_config[sensor->source].pin;
 327              		.loc 1 94 19 view .LVU107
 328 000a 90F90B10 		ldrsb	r1, [r0, #11]
 329              		.loc 1 94 28 view .LVU108
 330 000e 0A4B     		ldr	r3, .L24
  87:../application/Src/as5048a.c **** 	sensor->tx_complete = 1;
 331              		.loc 1 87 22 view .LVU109
 332 0010 0281     		strh	r2, [r0, #8]	@ movhi
  90:../application/Src/as5048a.c **** 	gtmp_buf[1] = 0xFF;		// 
 333              		.loc 1 90 2 is_stmt 1 view .LVU110
 334              		.loc 1 94 28 is_stmt 0 view .LVU111
 335 0012 53F83120 		ldr	r2, [r3, r1, lsl #3]
 336              		.loc 1 94 69 view .LVU112
 337 0016 03EBC103 		add	r3, r3, r1, lsl #3
 338 001a 9E88     		ldrh	r6, [r3, #4]
  95:../application/Src/as5048a.c **** 	SPI_FullDuplex_TransmitReceive(gtmp_buf, sensor->data, 2, AS5048A_SPI_MODE);
 339              		.loc 1 95 2 view .LVU113
 340 001c 00F10E01 		add	r1, r0, #14
  94:../application/Src/as5048a.c **** 	SPI_FullDuplex_TransmitReceive(gtmp_buf, sensor->data, 2, AS5048A_SPI_MODE);
 341              		.loc 1 94 39 view .LVU114
 342 0020 D368     		ldr	r3, [r2, #12]
  90:../application/Src/as5048a.c **** 	gtmp_buf[1] = 0xFF;		// 
 343              		.loc 1 90 14 view .LVU115
 344 0022 0648     		ldr	r0, .L24+4
 345              	.LVL22:
  94:../application/Src/as5048a.c **** 	SPI_FullDuplex_TransmitReceive(gtmp_buf, sensor->data, 2, AS5048A_SPI_MODE);
 346              		.loc 1 94 39 view .LVU116
 347 0024 23EA0603 		bic	r3, r3, r6
  90:../application/Src/as5048a.c **** 	gtmp_buf[1] = 0xFF;		// 
 348              		.loc 1 90 14 view .LVU117
 349 0028 0570     		strb	r5, [r0]
  91:../application/Src/as5048a.c **** 	
 350              		.loc 1 91 2 is_stmt 1 view .LVU118
  91:../application/Src/as5048a.c **** 	
 351              		.loc 1 91 14 is_stmt 0 view .LVU119
 352 002a 4470     		strb	r4, [r0, #1]
  94:../application/Src/as5048a.c **** 	SPI_FullDuplex_TransmitReceive(gtmp_buf, sensor->data, 2, AS5048A_SPI_MODE);
 353              		.loc 1 94 2 is_stmt 1 view .LVU120
 354              		.loc 1 95 2 view .LVU121
  94:../application/Src/as5048a.c **** 	SPI_FullDuplex_TransmitReceive(gtmp_buf, sensor->data, 2, AS5048A_SPI_MODE);
 355              		.loc 1 94 39 is_stmt 0 view .LVU122
 356 002c D360     		str	r3, [r2, #12]
  96:../application/Src/as5048a.c **** }
 357              		.loc 1 96 1 view .LVU123
ARM GAS  /tmp/ccsKh3k1.s 			page 10


 358 002e 70BC     		pop	{r4, r5, r6}
 359              	.LCFI3:
 360              		.cfi_restore 6
 361              		.cfi_restore 5
 362              		.cfi_restore 4
 363              		.cfi_def_cfa_offset 0
  95:../application/Src/as5048a.c **** }
 364              		.loc 1 95 2 view .LVU124
 365 0030 0123     		movs	r3, #1
 366 0032 0222     		movs	r2, #2
 367 0034 FFF7FEBF 		b	SPI_FullDuplex_TransmitReceive
 368              	.LVL23:
 369              	.L25:
  95:../application/Src/as5048a.c **** }
 370              		.loc 1 95 2 view .LVU125
 371              		.align	2
 372              	.L24:
 373 0038 00000000 		.word	pin_config
 374 003c 00000000 		.word	gtmp_buf
 375              		.cfi_endproc
 376              	.LFE31:
 378              		.section	.text.AS5048A_StopDMA,"ax",%progbits
 379              		.align	1
 380              		.p2align 2,,3
 381              		.global	AS5048A_StopDMA
 382              		.syntax unified
 383              		.thumb
 384              		.thumb_func
 385              		.fpu softvfp
 387              	AS5048A_StopDMA:
 388              	.LVL24:
 389              	.LFB32:
  97:../application/Src/as5048a.c **** 
  98:../application/Src/as5048a.c **** void AS5048A_StopDMA(sensor_t * sensor)
  99:../application/Src/as5048a.c **** {	
 390              		.loc 1 99 1 is_stmt 1 view -0
 391              		.cfi_startproc
 392              		@ args = 0, pretend = 0, frame = 0
 393              		@ frame_needed = 0, uses_anonymous_args = 0
 100:../application/Src/as5048a.c **** 	DMA_Cmd(DMA1_Channel2, DISABLE);
 394              		.loc 1 100 2 view .LVU127
  99:../application/Src/as5048a.c **** 	DMA_Cmd(DMA1_Channel2, DISABLE);
 395              		.loc 1 99 1 is_stmt 0 view .LVU128
 396 0000 10B5     		push	{r4, lr}
 397              	.LCFI4:
 398              		.cfi_def_cfa_offset 8
 399              		.cfi_offset 4, -8
 400              		.cfi_offset 14, -4
  99:../application/Src/as5048a.c **** 	DMA_Cmd(DMA1_Channel2, DISABLE);
 401              		.loc 1 99 1 view .LVU129
 402 0002 0446     		mov	r4, r0
 403              		.loc 1 100 2 view .LVU130
 404 0004 0021     		movs	r1, #0
 405 0006 0948     		ldr	r0, .L28
 406              	.LVL25:
 407              		.loc 1 100 2 view .LVU131
 408 0008 FFF7FEFF 		bl	DMA_Cmd
ARM GAS  /tmp/ccsKh3k1.s 			page 11


 409              	.LVL26:
 101:../application/Src/as5048a.c **** 	// CS high
 102:../application/Src/as5048a.c **** 	pin_config[sensor->source].port->ODR |= pin_config[sensor->source].pin;
 410              		.loc 1 102 2 is_stmt 1 view .LVU132
 103:../application/Src/as5048a.c **** 	sensor->rx_complete = 1;
 411              		.loc 1 103 22 is_stmt 0 view .LVU133
 412 000c 40F20110 		movw	r0, #257
 102:../application/Src/as5048a.c **** 	sensor->rx_complete = 1;
 413              		.loc 1 102 19 view .LVU134
 414 0010 94F90B10 		ldrsb	r1, [r4, #11]
 102:../application/Src/as5048a.c **** 	sensor->rx_complete = 1;
 415              		.loc 1 102 28 view .LVU135
 416 0014 064B     		ldr	r3, .L28+4
 417 0016 53F83120 		ldr	r2, [r3, r1, lsl #3]
 102:../application/Src/as5048a.c **** 	sensor->rx_complete = 1;
 418              		.loc 1 102 68 view .LVU136
 419 001a 03EBC103 		add	r3, r3, r1, lsl #3
 420 001e 9B88     		ldrh	r3, [r3, #4]
 102:../application/Src/as5048a.c **** 	sensor->rx_complete = 1;
 421              		.loc 1 102 39 view .LVU137
 422 0020 D168     		ldr	r1, [r2, #12]
 423 0022 0B43     		orrs	r3, r3, r1
 424 0024 D360     		str	r3, [r2, #12]
 425              		.loc 1 103 2 is_stmt 1 view .LVU138
 104:../application/Src/as5048a.c **** 	sensor->tx_complete = 1;
 426              		.loc 1 104 2 view .LVU139
 103:../application/Src/as5048a.c **** 	sensor->rx_complete = 1;
 427              		.loc 1 103 22 is_stmt 0 view .LVU140
 428 0026 2081     		strh	r0, [r4, #8]	@ movhi
 105:../application/Src/as5048a.c **** 
 106:../application/Src/as5048a.c **** }
 429              		.loc 1 106 1 view .LVU141
 430 0028 10BD     		pop	{r4, pc}
 431              	.LVL27:
 432              	.L29:
 433              		.loc 1 106 1 view .LVU142
 434 002a 00BF     		.align	2
 435              	.L28:
 436 002c 1C000240 		.word	1073872924
 437 0030 00000000 		.word	pin_config
 438              		.cfi_endproc
 439              	.LFE32:
 441              		.comm	gtmp_buf,2,4
 442              		.text
 443              	.Letext0:
 444              		.file 2 "/usr/lib/gcc/arm-none-eabi/9.2.1/include/stdint.h"
 445              		.file 3 "../application/Inc/common_types.h"
 446              		.file 4 "../Drivers/CMSIS/CM3/CoreSupport/core_cm3.h"
 447              		.file 5 "../Drivers/CMSIS/CM3/DeviceSupport/ST/STM32F10x/system_stm32f10x.h"
 448              		.file 6 "../Drivers/CMSIS/CM3/DeviceSupport/ST/STM32F10x/stm32f10x.h"
 449              		.file 7 "/usr/lib/gcc/arm-none-eabi/9.2.1/include/stddef.h"
 450              		.file 8 "/usr/include/newlib/sys/_types.h"
 451              		.file 9 "/usr/include/newlib/sys/reent.h"
 452              		.file 10 "/usr/include/newlib/sys/lock.h"
 453              		.file 11 "../application/Inc/periphery.h"
 454              		.file 12 "../Drivers/STM32F10x_StdPeriph_Driver/inc/stm32f10x_dma.h"
 455              		.file 13 "../application/Inc/spi.h"
ARM GAS  /tmp/ccsKh3k1.s 			page 12


ARM GAS  /tmp/ccsKh3k1.s 			page 13


DEFINED SYMBOLS
                            *ABS*:0000000000000000 as5048a.c
     /tmp/ccsKh3k1.s:16     .text.reset_err_flag:0000000000000000 $t
     /tmp/ccsKh3k1.s:25     .text.reset_err_flag:0000000000000000 reset_err_flag
     /tmp/ccsKh3k1.s:110    .text.reset_err_flag:0000000000000050 $d
                            *COM*:0000000000000002 gtmp_buf
     /tmp/ccsKh3k1.s:117    .text.AS5048A_GetData:0000000000000000 $t
     /tmp/ccsKh3k1.s:125    .text.AS5048A_GetData:0000000000000000 AS5048A_GetData
     /tmp/ccsKh3k1.s:286    .text.AS5048A_GetData:0000000000000090 $d
     /tmp/ccsKh3k1.s:296    .text.AS5048A_StartDMA:0000000000000000 $t
     /tmp/ccsKh3k1.s:304    .text.AS5048A_StartDMA:0000000000000000 AS5048A_StartDMA
     /tmp/ccsKh3k1.s:373    .text.AS5048A_StartDMA:0000000000000038 $d
     /tmp/ccsKh3k1.s:379    .text.AS5048A_StopDMA:0000000000000000 $t
     /tmp/ccsKh3k1.s:387    .text.AS5048A_StopDMA:0000000000000000 AS5048A_StopDMA
     /tmp/ccsKh3k1.s:436    .text.AS5048A_StopDMA:000000000000002c $d

UNDEFINED SYMBOLS
SPI_HalfDuplex_Transmit
DMA_GetCurrDataCounter
pin_config
SPI_FullDuplex_TransmitReceive
DMA_Cmd
